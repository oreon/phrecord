<template name="measurements">
	<h1 class="page-title">My Shopping List</h1>
    <h2> Welcome {{patient.firstName}}</h2>


    <div>
        {{> quickForm id="insertPtForm" type="update" collection="Patients"
        doc=patient fields="firstName,lastName, contactPhone"}}
    </div>

    <div id="msmts" class="tab-pane fade">
        {{> measurementTmplPt patient=patient }}
    </div>



	<ul class="shopping-list">
		{{#each shoppingList}}
			{{#each ingredients}}
				<li>{{name}} - <span class="amount">{{amount}}</span></li>
			{{/each}}
		{{else}}
			<li>Uh, oh. Please add <a href="/recipe-book">recipes</a> to your menu.</li>
		{{/each}}
	</ul>
</template>



<template name="measurementTmplPt">
    {{patient._id}}
    {{> msmtTbl measurements = patient.measurements  }}
    <h2>  BP Systolic</h2>
    {{#autoForm type="update-pushArray" collection="Patients"
    doc=patient scope="measurements"  id="mybpfrm"}}
        <fieldset>
            <legend>Discharge Patient</legend>
            {{> afQuickField name='measurement' }}

            {{> afQuickField name='mainValue' }}
        </fieldset>
        <button type="submit" class="btn btn-danger">Discharge</button>
    {{/autoForm}}

    <div>
        {{> quickForm id="insertBpForm" type="update-pushArray" collection="Patients"
        doc=patient scope="measurements" fields= "mainValue"}}
    </div>

    <h2>  Fasting Glucose</h2>
    <div>
        {{> quickForm id="insertFastingGlucoseForm" type="update-pushArray" collection="Patients"
        doc=patient scope="measurements" fields="mainValue"}}
    </div>
</template>

<template name="msmtTbl">
    {{#if measurements}}
        <table class="table table-striped table-bordered table-condensed">
            <thead>
            <tr style="background:#88a; color: #ffd">
                <th>Name</th>
                <th>Value</th>
                <th>Created</th>
                <th> Source</th>
                <th> </th>
            </tr>
            </thead>
            <tbody>
            {{#each measurements}}
                <tr>
                    <td>{{measurement}}</td>
                    <td> {{mainValue}} </td>
                    <td> {{ updatedAt}} </td>
                    <td> {{source}} </td>
                    <td> <button class="btn btn-deny deleteMeasurement" name='{{drug}}' > Delete </button> </td>
                </tr>
            {{/each}}
            </tbody>
        </table>
    {{else}}
        <h3> No Measurements recorded yet. </h3>
    {{/if}}
</template>